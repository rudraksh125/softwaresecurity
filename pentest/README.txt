Karthik Vivekanandan
1207683239

Overview:

Hint 2 gave away the use of the'cksum' algorithm - the hash is the checksum of the program, which the server checks against new submissions. 

The .pub file is the public key of the server, and the .gpg file is the signature of the server, signed using its private key. 

The checksum of the code file is calculated using the 'cksum' command and piped into a .hash file, which is then encrypted using the public key of the server. Because the public key has expired, I had to change the system time to 11/11/2010, a value between the created-expiry date in the certificate. The public key file is used to encrypt the program and is then submitted to the server. Bacause the hash matches the one calculated by the server, it executes the program. The contents of the 'secret.txt' file is printed to the standard out using the cat system command.

Debugging:

LM-SFA-00873477:~ kvivekanandan$ gpg --list-keys
/Users/kvivekanandan/.gnupg/pubring.gpg
---------------------------------------
pub   2048D/00D026C4 2010-08-19 [expires: 2018-08-19]
uid                  GPGTools Team <team@gpgtools.org>
uid                  GPGMail Project Team (Official OpenPGP Key) <gpgmail-devel@lists.gpgmail.org>
uid                  GPGTools Project Team (Official OpenPGP Key) <gpgtools-org@lists.gpgtools.org>
uid                  [jpeg image of size 5871]
sub   2048g/DBCBE671 2010-08-19 [expires: 2018-08-19]
sub   4096R/0D9E43F5 2014-04-08 [expires: 2024-01-02]

pub   4096R/BEB18AF4 2016-03-01 [expires: 2020-03-01]
uid                  Karthik Vivek <kvivekan@asu.edu>
sub   4096R/C1B3AA96 2016-03-01 [expires: 2020-03-01]

pub   4096R/305BA344 2010-10-01 [expired: 2010-12-10]
uid                  Assignment 1 CS 279

LM-SFA-00873477:~ kvivekanandan$ gpg -vvvv </Users/kvivekanandan/Desktop/ASU/CSE_545_Software_Security/softwaresecurity/pentest/assignment1.pub 
gpg: using character set `utf-8'
:public key packet:
	version 4, algo 1, created 1285972135, expires 0
	pkey[0]: [4096 bits]
	pkey[1]: [17 bits]
	keyid: 90484CDF305BA344
:user ID packet: "Assignment 1 CS 279"
:signature packet: algo 1, keyid 90484CDF305BA344
	version 4, created 1285972135, md5len 0, sigclass 0x13
	digest algo 2, begin of digest 98 b4
	hashed subpkt 2 len 4 (sig created 2010-10-01)
	hashed subpkt 27 len 1 (key flags: 03)
	hashed subpkt 9 len 4 (key expires after 70d0h0m)
	hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
	hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
	hashed subpkt 22 len 3 (pref-zip-algos: 2 3 1)
	hashed subpkt 30 len 1 (features: 01)
	hashed subpkt 23 len 1 (key server preferences: 80)
	subpkt 16 len 8 (issuer key ID 90484CDF305BA344)
	data: [4096 bits]
:public sub key packet:
	version 4, algo 1, created 1285972135, expires 0
	pkey[0]: [4096 bits]
	pkey[1]: [17 bits]
	keyid: 27131908FCA9A7D3
:signature packet: algo 1, keyid 90484CDF305BA344
	version 4, created 1285972135, md5len 0, sigclass 0x18
	digest algo 2, begin of digest 90 c3
	hashed subpkt 2 len 4 (sig created 2010-10-01)
	hashed subpkt 27 len 1 (key flags: 0C)
	hashed subpkt 9 len 4 (key expires after 70d0h0m)
	subpkt 16 len 8 (issuer key ID 90484CDF305BA344)
	data: [4095 bits]
gpg: NOTE: signature key 305BA344 expired Fri Dec 10 15:28:55 2010 MST
pub  4096R/305BA344 2010-10-01 Assignment 1 CS 279
sig        305BA344 2010-10-01   [selfsig]
sub  4096R/FCA9A7D3 2010-10-01 [expires: 2010-12-10]
sig        305BA344 2010-10-01   [keybind]


LM-SFA-00873477:~ kvivekanandan$ gpg -d /Users/kvivekanandan/Desktop/ASU/CSE_545_Software_Security/softwaresecurity/pentest/example.py.hash.gpg 
2695300100gpg: Signature made Sun Oct  3 21:13:51 2010 MST using RSA key ID 305BA344
gpg: Good signature from "Assignment 1 CS 279"
gpg: Note: This key has expired!
Primary key fingerprint: BB11 3CD7 018B 6F60 C1BF  864C 9048 4CDF 305B A344

LM-SFA-00873477:~ kvivekanandan$ gpg --verify /Users/kvivekanandan/Desktop/ASU/CSE_545_Software_Security/softwaresecurity/pentest/example.py.hash.gpg 
gpg: Signature made Sun Oct  3 21:13:51 2010 MST using RSA key ID 305BA344
gpg: Good signature from "Assignment 1 CS 279"
gpg: Note: This key has expired!
Primary key fingerprint: BB11 3CD7 018B 6F60 C1BF  864C 9048 4CDF 305B A344

LM-SFA-00873477:~ kvivekanandan$ gpg --decrypt /Users/kvivekanandan/Desktop/ASU/CSE_545_Software_Security/softwaresecurity/pentest/example.py.hash.gpg 
2695300100gpg: Signature made Sun Oct  3 21:13:51 2010 MST using RSA key ID 305BA344
gpg: Good signature from "Assignment 1 CS 279"
gpg: Note: This key has expired!
Primary key fingerprint: BB11 3CD7 018B 6F60 C1BF  864C 9048 4CDF 305B A344

LM-SFA-00873477:~ kvivekanandan$ gpg -e -r "Assignment 1 CS 279" /Users/kvivekanandan/Desktop/ASU/CSE_545_Software_Security/softwaresecurity/pentest/example.py
gpg: Assignment 1 CS 279: skipped: unusable public key
gpg: /Users/kvivekanandan/Desktop/ASU/CSE_545_Software_Security/softwaresecurity/pentest/example.py: encryption failed: unusable public key

LM-SFA-00873477:~ kvivekanandan$ gpg --edit-key 305BA344
gpg (GnuPG) 1.4.19; Copyright (C) 2015 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.


pub  4096R/305BA344  created: 2010-10-01  expired: 2010-12-10  usage: SC  
                     trust: unknown       validity: expired
sub  4096R/FCA9A7D3  created: 2010-10-01  expired: 2010-12-10  usage: E   
[ expired] (1). Assignment 1 CS 279

gpg> key 0
          
pub  4096R/305BA344  created: 2010-10-01  expired: 2010-12-10  usage: SC  
                     trust: unknown       validity: expired
sub  4096R/FCA9A7D3  created: 2010-10-01  expired: 2010-12-10  usage: E   
[ expired] (1). Assignment 1 CS 279

gpg> expire
Need the secret key to do this.

#change system time

LM-SFA-00873477:~ kvivekanandan$ gpg -e -r "Assignment 1 CS 279" /Users/kvivekanandan/Desktop/ASU/CSE_545_Software_Security/softwaresecurity/pentest/example.py
gpg: key 305BA344 was created 50037701 seconds in the future (time warp or clock problem)

#change to valid time

LM-SFA-00873477:~ kvivekanandan$ cksum /Users/kvivekanandan/Desktop/ASU/CSE_545_Software_Security/softwaresecurity/pentest/example.py
3294837252 59 /Users/kvivekanandan/Desktop/ASU/CSE_545_Software_Security/softwaresecurity/pentest/example.py
LM-SFA-00873477:~ kvivekanandan$ gpg -e -r "Assignment 1 CS 279" /Users/kvivekanandan/Desktop/ASU/CSE_545_Software_Security/softwaresecurity/pentest/example.py.hash 
gpg: FCA9A7D3: There is no assurance this key belongs to the named user

pub  4096R/FCA9A7D3 2010-10-01 Assignment 1 CS 279
 Primary key fingerprint: BB11 3CD7 018B 6F60 C1BF  864C 9048 4CDF 305B A344
      Subkey fingerprint: 73CA 1A1A CA14 2717 F63F  206C 2713 1908 FCA9 A7D3

It is NOT certain that the key belongs to the person named
in the user ID.  If you *really* know what you are doing,
you may answer the next question with yes.

Use this key anyway? (y/N) y
File `/Users/kvivekanandan/Desktop/ASU/CSE_545_Software_Security/softwaresecurity/pentest/example.py.hash.gpg' exists. Overwrite? (y/N) y